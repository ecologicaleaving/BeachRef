# Story 4.1: match-schedule-display-components-foundation

## Status
Approved

## Story
**As a** referee,
**I want** to view tournament match schedules organized by day with clear match information,
**so that** I can efficiently navigate tournament scheduling and prepare for matches.

## Acceptance Criteria
1. Schedule tab displays matches organized by day using Accordion components
2. Each day shows match count badge and collapsible match details
3. Match cards display team names, court, time, and match status
4. Match status indicators show scheduled/live/completed states clearly
5. Mobile-responsive design maintains 48px touch targets for venue usage
6. Loading states display during schedule data fetching
7. Empty states handle tournaments with no scheduled matches gracefully

## Tasks / Subtasks
- [ ] Create tournament schedule tab component (AC: 1)
  - [ ] Add Schedule tab to existing TournamentDetailTabs component
  - [ ] Implement TournamentSchedule component with day-by-day organization
  - [ ] Use shadcn Accordion component for collapsible daily schedule sections
  - [ ] Integrate with existing tournament detail page routing
- [ ] Implement day-by-day schedule organization (AC: 1, 2)
  - [ ] Create ScheduleByDay component with proper date grouping
  - [ ] Add match count badges for each day using shadcn Badge component
  - [ ] Implement collapsible functionality for day sections
  - [ ] Handle timezone considerations for match scheduling
- [ ] Design match card components (AC: 3)
  - [ ] Create MatchCard component using shadcn Card component
  - [ ] Display team names, court assignment, and match timing
  - [ ] Add court number and match venue information
  - [ ] Implement responsive card layout for mobile and desktop
- [ ] Add match status indicators (AC: 4)
  - [ ] Create MatchStatus component with badge-based status indicators
  - [ ] Define status types: scheduled (blue), live (green), completed (gray), cancelled (red)
  - [ ] Add appropriate icons for each match status
  - [ ] Ensure status indicators are accessible with proper ARIA labels
- [ ] Implement mobile-responsive design (AC: 5)
  - [ ] Ensure 48px minimum touch targets for all interactive elements
  - [ ] Test schedule display on mobile devices with tournament venue gloves
  - [ ] Optimize accordion interaction for single-handed mobile usage
  - [ ] Validate responsive design across mobile, tablet, and desktop breakpoints
- [ ] Add loading and skeleton states (AC: 6)
  - [ ] Create TournamentScheduleSkeleton component using shadcn Skeleton
  - [ ] Implement loading states for initial schedule data fetch
  - [ ] Add progressive loading indicators for individual day sections
  - [ ] Ensure smooth loading transitions with appropriate timing
- [ ] Handle empty states gracefully (AC: 7)
  - [ ] Create EmptySchedule component for tournaments without matches
  - [ ] Add appropriate messaging for different empty states (no matches, loading error, etc.)
  - [ ] Provide helpful guidance for users when schedule data is unavailable
  - [ ] Ensure empty states maintain consistent design with tournament detail theme

## Dev Notes

### Epic 4 Foundation Context
[From Epic 4: Tournament Details Data Integration - Status: Ready for Implementation]
- Extends Epic 3's tournament detail foundation with match schedule functionality
- Builds upon existing shadcn component system from Epic 1 and Epic 2
- Maintains existing tournament detail page structure and navigation patterns
- Follows APIArchitecture.md specifications for data structure and component design

### Existing Architecture Integration Points
[Source: Epic 3 completed stories and APIArchitecture.md]

**Available Tournament Detail Components:**
- ✅ `components/tournament/TournamentDetailTabs.tsx` - Existing tab system to extend
- ✅ `components/tournament/TournamentDetailPage.tsx` - Main tournament detail container
- ✅ `components/tournament/TournamentBreadcrumb.tsx` - Navigation breadcrumbs
- ✅ `components/tournament/TournamentHeader.tsx` - Tournament information header

**Current Tournament Detail Tab Structure:**
```typescript
// Current Epic 3 tabs - to be extended with Schedule
const tabs = [
  { id: 'overview', label: 'Overview' }  // Existing from Epic 3
  // Epic 4 will add: { id: 'schedule', label: 'Schedule' }
]
```

**Epic 4 Schedule Tab Architecture:**
```typescript
// New tournament schedule structure
TournamentSchedule.tsx
├── ScheduleByDay.tsx           # Day-by-day accordion organization  
├── MatchCard.tsx              # Individual match display cards
├── MatchStatus.tsx            # Match status indicators with badges
├── TournamentScheduleSkeleton.tsx  # Loading states
└── EmptySchedule.tsx          # Empty state handling
```

### Mock Data Structure for Story 4.1
[Source: APIArchitecture.md BeachMatch interface specification]

**Mock Match Data Structure (for UI development):**
```typescript
interface MockBeachMatch {
  noInTournament: string        // "M001", "M002", etc.
  localDate: string            // "2025-08-15"
  localTime: string            // "09:00"
  teamAName: string            // "Smith/Jones"
  teamBName: string            // "Wilson/Davis"
  court: string                // "Court 1"
  status: 'scheduled' | 'live' | 'completed' | 'cancelled'
}

// Mock data for development (Story 4.1 uses this, Story 4.3 replaces with real API)
const mockScheduleData: MockBeachMatch[] = [
  {
    noInTournament: "M001",
    localDate: "2025-08-15",
    localTime: "09:00",
    teamAName: "Smith/Jones",
    teamBName: "Wilson/Davis", 
    court: "Court 1",
    status: "scheduled"
  },
  // Additional mock matches for comprehensive UI testing
]
```

**Day Grouping Logic:**
```typescript
// Group matches by date for accordion organization
function groupMatchesByDay(matches: MockBeachMatch[]) {
  return matches.reduce((groups, match) => {
    const date = match.localDate
    if (!groups[date]) {
      groups[date] = []
    }
    groups[date].push(match)
    return groups
  }, {} as Record<string, MockBeachMatch[]>)
}
```

### Component Design Specifications

**ScheduleByDay Component Pattern:**
```typescript
// Day-by-day accordion using shadcn Accordion
<Accordion type="multiple" className="space-y-2">
  {Object.entries(groupedMatches).map(([date, matches]) => (
    <AccordionItem key={date} value={date}>
      <AccordionTrigger className="hover:no-underline">
        <div className="flex items-center justify-between w-full">
          <span className="text-lg font-medium">
            {formatDisplayDate(date)}
          </span>
          <Badge variant="secondary" className="ml-2">
            {matches.length} matches
          </Badge>
        </div>
      </AccordionTrigger>
      <AccordionContent className="space-y-3 pt-4">
        {matches.map((match) => (
          <MatchCard key={match.noInTournament} match={match} />
        ))}
      </AccordionContent>
    </AccordionItem>
  ))}
</Accordion>
```

**MatchCard Component Pattern:**
```typescript
// Individual match display using shadcn Card
<Card className="p-4 hover:shadow-md transition-shadow">
  <div className="flex items-center justify-between">
    <div className="flex-1">
      <div className="flex items-center space-x-4">
        <div className="text-sm font-medium">{match.localTime}</div>
        <div className="text-sm text-gray-600">{match.court}</div>
      </div>
      <div className="mt-2">
        <div className="font-medium">{match.teamAName}</div>
        <div className="text-sm text-gray-600">vs</div>
        <div className="font-medium">{match.teamBName}</div>
      </div>
    </div>
    <div className="flex-shrink-0">
      <MatchStatus status={match.status} />
    </div>
  </div>
</Card>
```

**MatchStatus Component Pattern:**
```typescript
// Status indicators using shadcn Badge with consistent color scheme
function MatchStatus({ status }: { status: MatchStatus }) {
  const statusConfig = {
    scheduled: { variant: 'secondary', label: 'Scheduled', color: 'blue' },
    live: { variant: 'default', label: 'Live', color: 'green' },
    completed: { variant: 'outline', label: 'Completed', color: 'gray' },
    cancelled: { variant: 'destructive', label: 'Cancelled', color: 'red' }
  }
  
  const config = statusConfig[status]
  
  return (
    <Badge variant={config.variant} className={`bg-${config.color}-100 text-${config.color}-800`}>
      {config.label}
    </Badge>
  )
}
```

### File Locations and Naming Conventions
[Source: Established patterns from Epic 3 and project structure]

**New Files to Create:**
- `components/tournament/schedule/TournamentSchedule.tsx` - Main schedule container
- `components/tournament/schedule/ScheduleByDay.tsx` - Day-by-day accordion organization
- `components/tournament/schedule/MatchCard.tsx` - Individual match display
- `components/tournament/schedule/MatchStatus.tsx` - Status indicator component
- `components/tournament/schedule/TournamentScheduleSkeleton.tsx` - Loading states
- `components/tournament/schedule/EmptySchedule.tsx` - Empty state component

**Files to Modify:**
- `components/tournament/TournamentDetailTabs.tsx` - Add Schedule tab
- `components/tournament/TournamentDetailPage.tsx` - Integrate schedule components

**Directory Structure:**
```
components/tournament/
├── TournamentDetailTabs.tsx     # MODIFY: Add Schedule tab
├── TournamentDetailPage.tsx     # MODIFY: Integrate schedule
└── schedule/                    # NEW: Schedule-specific components
    ├── TournamentSchedule.tsx   # Main schedule container
    ├── ScheduleByDay.tsx        # Day-by-day organization
    ├── MatchCard.tsx            # Match display cards
    ├── MatchStatus.tsx          # Status indicators
    ├── TournamentScheduleSkeleton.tsx  # Loading states
    └── EmptySchedule.tsx        # Empty states
```

### Mobile-First Responsive Design Requirements
[Source: Epic 1 and Epic 3 mobile requirements]

**Touch Target Standards:**
- All interactive elements maintain 48px minimum touch targets
- Accordion triggers optimized for tournament venue glove usage
- Match cards support single-handed mobile interaction
- Status indicators remain readable and accessible on small screens

**Responsive Breakpoints:**
- **Mobile (< 768px)**: Single column accordion with full-width match cards
- **Tablet (768px - 1024px)**: Slightly wider match cards with improved spacing
- **Desktop (> 1024px)**: Multi-column layout within accordion sections

**Accessibility Requirements:**
- All accordion sections keyboard navigable
- Screen reader support for match information and status
- High contrast status indicators for outdoor venue usage
- Focus management during accordion expand/collapse

### Performance Considerations

**Component Optimization:**
- Use React.memo for MatchCard components to prevent unnecessary re-renders
- Implement virtual scrolling for tournaments with large match counts (> 50 matches)
- Lazy load accordion content until user interaction

**Bundle Size Management:**
- Import only necessary shadcn components (Accordion, Card, Badge, Skeleton)
- Use dynamic imports for schedule components (loaded only when Schedule tab is accessed)
- Tree-shake unused utility functions

**Loading Performance:**
- Skeleton states load immediately while mock data is prepared
- Progressive disclosure - load current day first, then remaining days
- Optimize for mobile networks with appropriate data structure sizing

## Testing

### Test File Location
- Create new test: `__tests__/components/tournament/schedule/TournamentSchedule.test.tsx`
- Create new test: `__tests__/components/tournament/schedule/ScheduleByDay.test.tsx`
- Create new test: `__tests__/components/tournament/schedule/MatchCard.test.tsx`
- Create new test: `__tests__/components/tournament/schedule/MatchStatus.test.tsx`
- Update existing test: `__tests__/components/tournament/TournamentDetailTabs.test.tsx`

### Test Standards
- Use Jest + React Testing Library following existing project patterns
- Test responsive design with viewport simulation using @testing-library/jest-dom
- Test keyboard accessibility and screen reader support
- Mock tournament data using established patterns from Epic 3

### Testing Requirements for This Story
- Verify schedule tab displays in tournament detail tabs (AC: 1)
- Test day-by-day accordion organization with match count badges (AC: 1, 2)
- Validate match card display with team names, court, time, and status (AC: 3)
- Test match status indicators for all status types (scheduled/live/completed/cancelled) (AC: 4)
- Ensure 48px touch targets and mobile responsive design (AC: 5)
- Test loading skeleton states and smooth transitions (AC: 6)
- Validate empty state handling for tournaments without matches (AC: 7)
- Test accordion expand/collapse functionality with keyboard navigation
- Validate ARIA labels and screen reader accessibility
- Test responsive design across mobile, tablet, and desktop breakpoints

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-01 | 1.0 | Initial story creation for match schedule display components foundation based on Epic 4 and APIArchitecture.md specifications | Sarah (Product Owner) |